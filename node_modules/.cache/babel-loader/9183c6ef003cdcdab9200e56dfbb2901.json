{"remainingRequest":"D:\\vue02\\node_modules\\babel-loader\\lib\\index.js!D:\\vue02\\node_modules\\vuetify\\lib\\components\\VCalendar\\modes\\stack.js","dependencies":[{"path":"D:\\vue02\\node_modules\\vuetify\\lib\\components\\VCalendar\\modes\\stack.js","mtime":499162500000},{"path":"D:\\vue02\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\vue02\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IHsgZ2V0T3ZlcmxhcEdyb3VwSGFuZGxlciwgZ2V0VmlzdWFscywgaGFzT3ZlcmxhcCwgZ2V0Tm9ybWFsaXplZFJhbmdlIH0gZnJvbSAnLi9jb21tb24nOwppbXBvcnQgeyBnZXRUaW1lc3RhbXBJZGVudGlmaWVyIH0gZnJvbSAnLi4vdXRpbC90aW1lc3RhbXAnOwpjb25zdCBGVUxMX1dJRFRIID0gMTAwOwpjb25zdCBERUZBVUxUX09GRlNFVCA9IDU7CmNvbnN0IFdJRFRIX01VTFRJUExJRVIgPSAxLjc7Ci8qKgogKiBWYXJpYXRpb24gb2YgY29sdW1uIG1vZGUgd2hlcmUgZXZlbnRzIGNhbiBiZSBzdGFja2VkLiBUaGUgcHJpb3JpdHkgb2YgdGhpcwogKiBtb2RlIGlzIHRvIHN0YWNrIGV2ZW50cyB0b2dldGhlciB0YWtpbmcgdXAgdGhlIGxlYXN0IGFtb3VudCBvZiBzcGFjZSB3aGlsZQogKiB0cnlpbmcgdG8gZW5zdXJlIHRoZSBjb250ZW50IG9mIHRoZSBldmVudCBpcyBhbHdheXMgdmlzaWJsZSBhcyB3ZWxsIGFzIGl0cwogKiBzdGFydCBhbmQgZW5kLiBBIHNpYmxpbmcgY29sdW1uIGhhcyBpbnRlcnNlY3RpbmcgZXZlbnQgY29udGVudCBhbmQgbXVzdCBiZQogKiBwbGFjZWQgYmVzaWRlIGVhY2ggb3RoZXIuIE5vbi1zaWJsaW5nIGNvbHVtbnMgYXJlIG9mZnNldCBieSA1JSBmcm9tIHRoZQogKiBwcmV2aW91cyBjb2x1bW4uIFRoZSB3aWR0aCBpcyBzY2FsZWQgYnkgMS43IHNvIHRoZSBldmVudHMgb3ZlcmxhcCBhbmQKICogd2hpdGVzcGFjZSBpcyByZWR1Y2VkLiBJZiB0aGVyZSBpcyBhIGhvbGUgaW4gY29sdW1ucyB0aGUgZXZlbnQgd2lkdGggaXMKICogc2NhbGVkIHVwIHNvIGl0IGludGVyc2VjdHMgd2l0aCB0aGUgbmV4dCBjb2x1bW4uIFRoZSBjb2x1bW5zIGhhdmUgZXF1YWwKICogd2lkdGggaW4gdGhlIHNwYWNlIHRoZXkgYXJlIGdpdmVuLiBJZiB0aGUgZXZlbnQgZG9lc24ndCBoYXZlIGFueSB0byB0aGUKICogcmlnaHQgb2YgaXQgdGhhdCBpbnRlcnNlY3Qgd2l0aCBpdCdzIGNvbnRlbnQgaXQncyByaWdodCBzaWRlIGlzIGV4dGVuZGVkCiAqIHRvIHRoZSByaWdodCBzaWRlLgogKi8KCmV4cG9ydCBjb25zdCBzdGFjayA9IChldmVudHMsIGZpcnN0V2Vla2RheSwgb3ZlcmxhcFRocmVzaG9sZCkgPT4gewogIGNvbnN0IGhhbmRsZXIgPSBnZXRPdmVybGFwR3JvdXBIYW5kbGVyKGZpcnN0V2Vla2RheSk7IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBtYXgtc3RhdGVtZW50cwoKICByZXR1cm4gKGRheSwgZGF5RXZlbnRzLCB0aW1lZCkgPT4gewogICAgaWYgKCF0aW1lZCkgewogICAgICByZXR1cm4gaGFuZGxlci5nZXRWaXN1YWxzKGRheSwgZGF5RXZlbnRzLCB0aW1lZCk7CiAgICB9CgogICAgY29uc3QgZGF5U3RhcnQgPSBnZXRUaW1lc3RhbXBJZGVudGlmaWVyKGRheSk7CiAgICBjb25zdCB2aXN1YWxzID0gZ2V0VmlzdWFscyhkYXlFdmVudHMsIGRheVN0YXJ0KTsKICAgIGNvbnN0IGdyb3VwcyA9IGdldEdyb3Vwcyh2aXN1YWxzLCBkYXlTdGFydCk7CgogICAgZm9yIChjb25zdCBncm91cCBvZiBncm91cHMpIHsKICAgICAgY29uc3Qgbm9kZXMgPSBbXTsKCiAgICAgIGZvciAoY29uc3QgdmlzdWFsIG9mIGdyb3VwLnZpc3VhbHMpIHsKICAgICAgICBjb25zdCBjaGlsZCA9IGdldE5vZGUodmlzdWFsLCBkYXlTdGFydCk7CiAgICAgICAgY29uc3QgaW5kZXggPSBnZXROZXh0SW5kZXgoY2hpbGQsIG5vZGVzKTsKCiAgICAgICAgaWYgKGluZGV4ID09PSBmYWxzZSkgewogICAgICAgICAgY29uc3QgcGFyZW50ID0gZ2V0UGFyZW50KGNoaWxkLCBub2Rlcyk7CgogICAgICAgICAgaWYgKHBhcmVudCkgewogICAgICAgICAgICBjaGlsZC5wYXJlbnQgPSBwYXJlbnQ7CiAgICAgICAgICAgIGNoaWxkLnNpYmxpbmcgPSBoYXNPdmVybGFwKGNoaWxkLnN0YXJ0LCBjaGlsZC5lbmQsIHBhcmVudC5zdGFydCwgYWRkVGltZShwYXJlbnQuc3RhcnQsIG92ZXJsYXBUaHJlc2hvbGQpKTsKICAgICAgICAgICAgY2hpbGQuaW5kZXggPSBwYXJlbnQuaW5kZXggKyAxOwogICAgICAgICAgICBwYXJlbnQuY2hpbGRyZW4ucHVzaChjaGlsZCk7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNvbnN0IFtwYXJlbnRdID0gZ2V0T3ZlcmxhcHBpbmdSYW5nZShjaGlsZCwgbm9kZXMsIGluZGV4IC0gMSwgaW5kZXggLSAxKTsKICAgICAgICAgIGNvbnN0IGNoaWxkcmVuID0gZ2V0T3ZlcmxhcHBpbmdSYW5nZShjaGlsZCwgbm9kZXMsIGluZGV4ICsgMSwgaW5kZXggKyBub2Rlcy5sZW5ndGgsIHRydWUpOwogICAgICAgICAgY2hpbGQuY2hpbGRyZW4gPSBjaGlsZHJlbjsKICAgICAgICAgIGNoaWxkLmluZGV4ID0gaW5kZXg7CgogICAgICAgICAgaWYgKHBhcmVudCkgewogICAgICAgICAgICBjaGlsZC5wYXJlbnQgPSBwYXJlbnQ7CiAgICAgICAgICAgIGNoaWxkLnNpYmxpbmcgPSBoYXNPdmVybGFwKGNoaWxkLnN0YXJ0LCBjaGlsZC5lbmQsIHBhcmVudC5zdGFydCwgYWRkVGltZShwYXJlbnQuc3RhcnQsIG92ZXJsYXBUaHJlc2hvbGQpKTsKICAgICAgICAgICAgcGFyZW50LmNoaWxkcmVuLnB1c2goY2hpbGQpOwogICAgICAgICAgfQoKICAgICAgICAgIGZvciAoY29uc3QgZ3JhbmQgb2YgY2hpbGRyZW4pIHsKICAgICAgICAgICAgaWYgKGdyYW5kLnBhcmVudCA9PT0gcGFyZW50KSB7CiAgICAgICAgICAgICAgZ3JhbmQucGFyZW50ID0gY2hpbGQ7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGNvbnN0IGdyYW5kTmV4dCA9IGdyYW5kLmluZGV4IC0gY2hpbGQuaW5kZXggPD0gMTsKCiAgICAgICAgICAgIGlmIChncmFuZE5leHQgJiYgY2hpbGQuc2libGluZyAmJiBoYXNPdmVybGFwKGNoaWxkLnN0YXJ0LCBhZGRUaW1lKGNoaWxkLnN0YXJ0LCBvdmVybGFwVGhyZXNob2xkKSwgZ3JhbmQuc3RhcnQsIGdyYW5kLmVuZCkpIHsKICAgICAgICAgICAgICBncmFuZC5zaWJsaW5nID0gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgbm9kZXMucHVzaChjaGlsZCk7CiAgICAgIH0KCiAgICAgIGNhbGN1bGF0ZUJvdW5kcyhub2Rlcywgb3ZlcmxhcFRocmVzaG9sZCk7CiAgICB9CgogICAgdmlzdWFscy5zb3J0KChhLCBiKSA9PiBhLmxlZnQgLSBiLmxlZnQgfHwgYS5ldmVudC5zdGFydFRpbWVzdGFtcElkZW50aWZpZXIgLSBiLmV2ZW50LnN0YXJ0VGltZXN0YW1wSWRlbnRpZmllcik7CiAgICByZXR1cm4gdmlzdWFsczsKICB9Owp9OwoKZnVuY3Rpb24gY2FsY3VsYXRlQm91bmRzKG5vZGVzLCBvdmVybGFwVGhyZXNob2xkKSB7CiAgZm9yIChjb25zdCBub2RlIG9mIG5vZGVzKSB7CiAgICBjb25zdCB7CiAgICAgIHZpc3VhbCwKICAgICAgcGFyZW50CiAgICB9ID0gbm9kZTsKICAgIGNvbnN0IGNvbHVtbnMgPSBnZXRNYXhDaGlsZEluZGV4KG5vZGUpICsgMTsKICAgIGNvbnN0IHNwYWNlTGVmdCA9IHBhcmVudCA/IHBhcmVudC52aXN1YWwubGVmdCA6IDA7CiAgICBjb25zdCBzcGFjZVdpZHRoID0gRlVMTF9XSURUSCAtIHNwYWNlTGVmdDsKICAgIGNvbnN0IG9mZnNldCA9IE1hdGgubWluKERFRkFVTFRfT0ZGU0VULCBGVUxMX1dJRFRIIC8gY29sdW1ucyk7CiAgICBjb25zdCBjb2x1bW5XaWR0aE11bHRpcGxpZXIgPSBnZXRDb2x1bW5XaWR0aE11bHRpcGxpZXIobm9kZSwgbm9kZXMpOwogICAgY29uc3QgY29sdW1uT2Zmc2V0ID0gc3BhY2VXaWR0aCAvIChjb2x1bW5zIC0gbm9kZS5pbmRleCArIDEpOwogICAgY29uc3QgY29sdW1uV2lkdGggPSBzcGFjZVdpZHRoIC8gKGNvbHVtbnMgLSBub2RlLmluZGV4ICsgKG5vZGUuc2libGluZyA/IDEgOiAwKSkgKiBjb2x1bW5XaWR0aE11bHRpcGxpZXI7CgogICAgaWYgKHBhcmVudCkgewogICAgICB2aXN1YWwubGVmdCA9IG5vZGUuc2libGluZyA/IHNwYWNlTGVmdCArIGNvbHVtbk9mZnNldCA6IHNwYWNlTGVmdCArIG9mZnNldDsKICAgIH0KCiAgICB2aXN1YWwud2lkdGggPSBoYXNGdWxsV2lkdGgobm9kZSwgbm9kZXMsIG92ZXJsYXBUaHJlc2hvbGQpID8gRlVMTF9XSURUSCAtIHZpc3VhbC5sZWZ0IDogTWF0aC5taW4oRlVMTF9XSURUSCAtIHZpc3VhbC5sZWZ0LCBjb2x1bW5XaWR0aCAqIFdJRFRIX01VTFRJUExJRVIpOwogIH0KfQoKZnVuY3Rpb24gZ2V0Q29sdW1uV2lkdGhNdWx0aXBsaWVyKG5vZGUsIG5vZGVzKSB7CiAgaWYgKCFub2RlLmNoaWxkcmVuLmxlbmd0aCkgewogICAgcmV0dXJuIDE7CiAgfQoKICBjb25zdCBtYXhDb2x1bW4gPSBub2RlLmluZGV4ICsgbm9kZXMubGVuZ3RoOwogIGNvbnN0IG1pbkNvbHVtbiA9IG5vZGUuY2hpbGRyZW4ucmVkdWNlKChtaW4sIGMpID0+IE1hdGgubWluKG1pbiwgYy5pbmRleCksIG1heENvbHVtbik7CiAgcmV0dXJuIG1pbkNvbHVtbiAtIG5vZGUuaW5kZXg7Cn0KCmZ1bmN0aW9uIGdldE92ZXJsYXBwaW5nSW5kaWNlcyhub2RlLCBub2RlcykgewogIGNvbnN0IGluZGljZXMgPSBbXTsKCiAgZm9yIChjb25zdCBvdGhlciBvZiBub2RlcykgewogICAgaWYgKGhhc092ZXJsYXAobm9kZS5zdGFydCwgbm9kZS5lbmQsIG90aGVyLnN0YXJ0LCBvdGhlci5lbmQpKSB7CiAgICAgIGluZGljZXMucHVzaChvdGhlci5pbmRleCk7CiAgICB9CiAgfQoKICByZXR1cm4gaW5kaWNlczsKfQoKZnVuY3Rpb24gZ2V0TmV4dEluZGV4KG5vZGUsIG5vZGVzKSB7CiAgY29uc3QgaW5kaWNlcyA9IGdldE92ZXJsYXBwaW5nSW5kaWNlcyhub2RlLCBub2Rlcyk7CiAgaW5kaWNlcy5zb3J0KCk7CgogIGZvciAobGV0IGkgPSAwOyBpIDwgaW5kaWNlcy5sZW5ndGg7IGkrKykgewogICAgaWYgKGkgPCBpbmRpY2VzW2ldKSB7CiAgICAgIHJldHVybiBpOwogICAgfQogIH0KCiAgcmV0dXJuIGZhbHNlOwp9CgpmdW5jdGlvbiBnZXRPdmVybGFwcGluZ1JhbmdlKG5vZGUsIG5vZGVzLCBpbmRleE1pbiwgaW5kZXhNYXgsIHJldHVybkZpcnN0Q29sdW1uID0gZmFsc2UpIHsKICBjb25zdCBvdmVybGFwcGluZyA9IFtdOwoKICBmb3IgKGNvbnN0IG90aGVyIG9mIG5vZGVzKSB7CiAgICBpZiAob3RoZXIuaW5kZXggPj0gaW5kZXhNaW4gJiYgb3RoZXIuaW5kZXggPD0gaW5kZXhNYXggJiYgaGFzT3ZlcmxhcChub2RlLnN0YXJ0LCBub2RlLmVuZCwgb3RoZXIuc3RhcnQsIG90aGVyLmVuZCkpIHsKICAgICAgb3ZlcmxhcHBpbmcucHVzaChvdGhlcik7CiAgICB9CiAgfQoKICBpZiAocmV0dXJuRmlyc3RDb2x1bW4gJiYgb3ZlcmxhcHBpbmcubGVuZ3RoID4gMCkgewogICAgY29uc3QgZmlyc3QgPSBvdmVybGFwcGluZy5yZWR1Y2UoKG1pbiwgbikgPT4gTWF0aC5taW4obWluLCBuLmluZGV4KSwgb3ZlcmxhcHBpbmdbMF0uaW5kZXgpOwogICAgcmV0dXJuIG92ZXJsYXBwaW5nLmZpbHRlcihuID0+IG4uaW5kZXggPT09IGZpcnN0KTsKICB9CgogIHJldHVybiBvdmVybGFwcGluZzsKfQoKZnVuY3Rpb24gZ2V0UGFyZW50KG5vZGUsIG5vZGVzKSB7CiAgbGV0IHBhcmVudCA9IG51bGw7CgogIGZvciAoY29uc3Qgb3RoZXIgb2Ygbm9kZXMpIHsKICAgIGlmIChoYXNPdmVybGFwKG5vZGUuc3RhcnQsIG5vZGUuZW5kLCBvdGhlci5zdGFydCwgb3RoZXIuZW5kKSAmJiAocGFyZW50ID09PSBudWxsIHx8IG90aGVyLmluZGV4ID4gcGFyZW50LmluZGV4KSkgewogICAgICBwYXJlbnQgPSBvdGhlcjsKICAgIH0KICB9CgogIHJldHVybiBwYXJlbnQ7Cn0KCmZ1bmN0aW9uIGhhc0Z1bGxXaWR0aChub2RlLCBub2Rlcywgb3ZlcmxhcFRocmVzaG9sZCkgewogIGZvciAoY29uc3Qgb3RoZXIgb2Ygbm9kZXMpIHsKICAgIGlmIChvdGhlciAhPT0gbm9kZSAmJiBvdGhlci5pbmRleCA+IG5vZGUuaW5kZXggJiYgaGFzT3ZlcmxhcChub2RlLnN0YXJ0LCBhZGRUaW1lKG5vZGUuc3RhcnQsIG92ZXJsYXBUaHJlc2hvbGQpLCBvdGhlci5zdGFydCwgb3RoZXIuZW5kKSkgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgfQoKICByZXR1cm4gdHJ1ZTsKfQoKZnVuY3Rpb24gZ2V0R3JvdXBzKHZpc3VhbHMsIGRheVN0YXJ0KSB7CiAgY29uc3QgZ3JvdXBzID0gW107CgogIGZvciAoY29uc3QgdmlzdWFsIG9mIHZpc3VhbHMpIHsKICAgIGNvbnN0IFtzdGFydCwgZW5kXSA9IGdldE5vcm1hbGl6ZWRSYW5nZSh2aXN1YWwuZXZlbnQsIGRheVN0YXJ0KTsKICAgIGxldCBhZGRlZCA9IGZhbHNlOwoKICAgIGZvciAoY29uc3QgZ3JvdXAgb2YgZ3JvdXBzKSB7CiAgICAgIGlmIChoYXNPdmVybGFwKHN0YXJ0LCBlbmQsIGdyb3VwLnN0YXJ0LCBncm91cC5lbmQpKSB7CiAgICAgICAgZ3JvdXAudmlzdWFscy5wdXNoKHZpc3VhbCk7CiAgICAgICAgZ3JvdXAuZW5kID0gTWF0aC5tYXgoZ3JvdXAuZW5kLCBlbmQpOwogICAgICAgIGFkZGVkID0gdHJ1ZTsKICAgICAgICBicmVhazsKICAgICAgfQogICAgfQoKICAgIGlmICghYWRkZWQpIHsKICAgICAgZ3JvdXBzLnB1c2goewogICAgICAgIHN0YXJ0LAogICAgICAgIGVuZCwKICAgICAgICB2aXN1YWxzOiBbdmlzdWFsXQogICAgICB9KTsKICAgIH0KICB9CgogIHJldHVybiBncm91cHM7Cn0KCmZ1bmN0aW9uIGdldE5vZGUodmlzdWFsLCBkYXlTdGFydCkgewogIGNvbnN0IFtzdGFydCwgZW5kXSA9IGdldE5vcm1hbGl6ZWRSYW5nZSh2aXN1YWwuZXZlbnQsIGRheVN0YXJ0KTsKICByZXR1cm4gewogICAgcGFyZW50OiBudWxsLAogICAgc2libGluZzogdHJ1ZSwKICAgIGluZGV4OiAwLAogICAgdmlzdWFsLAogICAgc3RhcnQsCiAgICBlbmQsCiAgICBjaGlsZHJlbjogW10KICB9Owp9CgpmdW5jdGlvbiBnZXRNYXhDaGlsZEluZGV4KG5vZGUpIHsKICBsZXQgbWF4ID0gbm9kZS5pbmRleDsKCiAgZm9yIChjb25zdCBjaGlsZCBvZiBub2RlLmNoaWxkcmVuKSB7CiAgICBjb25zdCBjaGlsZE1heCA9IGdldE1heENoaWxkSW5kZXgoY2hpbGQpOwoKICAgIGlmIChjaGlsZE1heCA+IG1heCkgewogICAgICBtYXggPSBjaGlsZE1heDsKICAgIH0KICB9CgogIHJldHVybiBtYXg7Cn0KCmZ1bmN0aW9uIGFkZFRpbWUoaWRlbnRpZmllciwgbWludXRlcykgewogIGNvbnN0IHJlbW92ZU1pbnV0ZXMgPSBpZGVudGlmaWVyICUgMTAwOwogIGNvbnN0IHRvdGFsTWludXRlcyA9IHJlbW92ZU1pbnV0ZXMgKyBtaW51dGVzOwogIGNvbnN0IGFkZEhvdXJzID0gTWF0aC5mbG9vcih0b3RhbE1pbnV0ZXMgLyA2MCk7CiAgY29uc3QgYWRkTWludXRlcyA9IHRvdGFsTWludXRlcyAlIDYwOwogIHJldHVybiBpZGVudGlmaWVyIC0gcmVtb3ZlTWludXRlcyArIGFkZEhvdXJzICogMTAwICsgYWRkTWludXRlczsKfQ=="},{"version":3,"sources":["../../../../src/components/VCalendar/modes/stack.ts"],"names":[],"mappings":"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","sourcesContent":["import { CalendarEventOverlapMode, CalendarEventVisual } from 'types'\nimport { getOverlapGroupHandler, getVisuals, hasOverlap, getNormalizedRange } from './common'\nimport { getTimestampIdentifier } from '../util/timestamp'\n\ninterface Group {\n  start: number\n  end: number\n  visuals: CalendarEventVisual[]\n}\n\ninterface Node {\n  parent: Node | null\n  sibling: boolean\n  index: number\n  visual: CalendarEventVisual\n  start: number\n  end: number\n  children: Node[]\n}\n\nconst FULL_WIDTH = 100\n\nconst DEFAULT_OFFSET = 5\n\nconst WIDTH_MULTIPLIER = 1.7\n\n/**\n * Variation of column mode where events can be stacked. The priority of this\n * mode is to stack events together taking up the least amount of space while\n * trying to ensure the content of the event is always visible as well as its\n * start and end. A sibling column has intersecting event content and must be\n * placed beside each other. Non-sibling columns are offset by 5% from the\n * previous column. The width is scaled by 1.7 so the events overlap and\n * whitespace is reduced. If there is a hole in columns the event width is\n * scaled up so it intersects with the next column. The columns have equal\n * width in the space they are given. If the event doesn't have any to the\n * right of it that intersect with it's content it's right side is extended\n * to the right side.\n */\n\nexport const stack: CalendarEventOverlapMode = (events, firstWeekday, overlapThreshold) => {\n  const handler = getOverlapGroupHandler(firstWeekday)\n\n  // eslint-disable-next-line max-statements\n  return (day, dayEvents, timed) => {\n    if (!timed) {\n      return handler.getVisuals(day, dayEvents, timed)\n    }\n\n    const dayStart = getTimestampIdentifier(day)\n    const visuals = getVisuals(dayEvents, dayStart)\n    const groups = getGroups(visuals, dayStart)\n\n    for (const group of groups) {\n      const nodes: Node[] = []\n\n      for (const visual of group.visuals) {\n        const child = getNode(visual, dayStart)\n        const index = getNextIndex(child, nodes)\n\n        if (index === false) {\n          const parent = getParent(child, nodes)\n          if (parent) {\n            child.parent = parent\n            child.sibling = hasOverlap(child.start, child.end, parent.start, addTime(parent.start, overlapThreshold))\n            child.index = parent.index + 1\n            parent.children.push(child)\n          }\n        } else {\n          const [parent] = getOverlappingRange(child, nodes, index - 1, index - 1)\n          const children = getOverlappingRange(child, nodes, index + 1, index + nodes.length, true)\n\n          child.children = children\n          child.index = index\n\n          if (parent) {\n            child.parent = parent\n            child.sibling = hasOverlap(child.start, child.end, parent.start, addTime(parent.start, overlapThreshold))\n            parent.children.push(child)\n          }\n\n          for (const grand of children) {\n            if (grand.parent === parent) {\n              grand.parent = child\n            }\n\n            const grandNext = grand.index - child.index <= 1\n            if (grandNext && child.sibling &&\n              hasOverlap(child.start, addTime(child.start, overlapThreshold), grand.start, grand.end)) {\n              grand.sibling = true\n            }\n          }\n        }\n\n        nodes.push(child)\n      }\n\n      calculateBounds(nodes, overlapThreshold)\n    }\n\n    visuals.sort((a, b) => (a.left - b.left) || (a.event.startTimestampIdentifier - b.event.startTimestampIdentifier))\n\n    return visuals\n  }\n}\n\nfunction calculateBounds (nodes: Node[], overlapThreshold: number) {\n  for (const node of nodes) {\n    const { visual, parent } = node\n    const columns = getMaxChildIndex(node) + 1\n    const spaceLeft = parent ? parent.visual.left : 0\n    const spaceWidth = FULL_WIDTH - spaceLeft\n    const offset = Math.min(DEFAULT_OFFSET, FULL_WIDTH / columns)\n    const columnWidthMultiplier = getColumnWidthMultiplier(node, nodes)\n    const columnOffset = spaceWidth / (columns - node.index + 1)\n    const columnWidth = spaceWidth / (columns - node.index + (node.sibling ? 1 : 0)) * columnWidthMultiplier\n\n    if (parent) {\n      visual.left = node.sibling\n        ? spaceLeft + columnOffset\n        : spaceLeft + offset\n    }\n\n    visual.width = hasFullWidth(node, nodes, overlapThreshold)\n      ? FULL_WIDTH - visual.left\n      : Math.min(FULL_WIDTH - visual.left, columnWidth * WIDTH_MULTIPLIER)\n  }\n}\n\nfunction getColumnWidthMultiplier (node: Node, nodes: Node[]): number {\n  if (!node.children.length) {\n    return 1\n  }\n\n  const maxColumn = node.index + nodes.length\n  const minColumn = node.children.reduce((min, c) => Math.min(min, c.index), maxColumn)\n\n  return minColumn - node.index\n}\n\nfunction getOverlappingIndices (node: Node, nodes: Node[]): number[] {\n  const indices: number[] = []\n  for (const other of nodes) {\n    if (hasOverlap(node.start, node.end, other.start, other.end)) {\n      indices.push(other.index)\n    }\n  }\n  return indices\n}\n\nfunction getNextIndex (node: Node, nodes: Node[]): number | false {\n  const indices = getOverlappingIndices(node, nodes)\n  indices.sort()\n\n  for (let i = 0; i < indices.length; i++) {\n    if (i < indices[i]) {\n      return i\n    }\n  }\n  return false\n}\n\nfunction getOverlappingRange (node: Node, nodes: Node[], indexMin: number, indexMax: number, returnFirstColumn = false): Node[] {\n  const overlapping: Node[] = []\n  for (const other of nodes) {\n    if (other.index >= indexMin && other.index <= indexMax && hasOverlap(node.start, node.end, other.start, other.end)) {\n      overlapping.push(other)\n    }\n  }\n  if (returnFirstColumn && overlapping.length > 0) {\n    const first = overlapping.reduce((min, n) => Math.min(min, n.index), overlapping[0].index)\n    return overlapping.filter(n => n.index === first)\n  }\n  return overlapping\n}\n\nfunction getParent (node: Node, nodes: Node[]): Node | null {\n  let parent: Node | null = null\n  for (const other of nodes) {\n    if (hasOverlap(node.start, node.end, other.start, other.end) && (parent === null || other.index > parent.index)) {\n      parent = other\n    }\n  }\n  return parent\n}\n\nfunction hasFullWidth (node: Node, nodes: Node[], overlapThreshold: number): boolean {\n  for (const other of nodes) {\n    if (other !== node &&\n      other.index > node.index &&\n      hasOverlap(node.start, addTime(node.start, overlapThreshold), other.start, other.end)) {\n      return false\n    }\n  }\n\n  return true\n}\n\nfunction getGroups (visuals: CalendarEventVisual[], dayStart: number): Group[] {\n  const groups: Group[] = []\n\n  for (const visual of visuals) {\n    const [start, end] = getNormalizedRange(visual.event, dayStart)\n    let added = false\n\n    for (const group of groups) {\n      if (hasOverlap(start, end, group.start, group.end)) {\n        group.visuals.push(visual)\n        group.end = Math.max(group.end, end)\n        added = true\n        break\n      }\n    }\n\n    if (!added) {\n      groups.push({ start, end, visuals: [visual] })\n    }\n  }\n\n  return groups\n}\n\nfunction getNode (visual: CalendarEventVisual, dayStart: number): Node {\n  const [start, end] = getNormalizedRange(visual.event, dayStart)\n\n  return {\n    parent: null,\n    sibling: true,\n    index: 0,\n    visual,\n    start,\n    end,\n    children: [],\n  }\n}\n\nfunction getMaxChildIndex (node: Node): number {\n  let max = node.index\n  for (const child of node.children) {\n    const childMax = getMaxChildIndex(child)\n    if (childMax > max) {\n      max = childMax\n    }\n  }\n  return max\n}\n\nfunction addTime (identifier: number, minutes: number): number {\n  const removeMinutes = identifier % 100\n  const totalMinutes = removeMinutes + minutes\n  const addHours = Math.floor(totalMinutes / 60)\n  const addMinutes = totalMinutes % 60\n\n  return identifier - removeMinutes + addHours * 100 + addMinutes\n}\n"],"sourceRoot":""}]}